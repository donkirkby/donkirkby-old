(units in mm)

#<cutReference> =       0
#<cutBoundary> =        1
#<cutPocket> =          0
#<cutProfile> =         0
#<cutEngraving> =       0
#<cutSquareEngraving> = 0
#<xmin> = -100
#<ymax> = 0
#<referenceX1> = -60
#<referenceX2> = 230
#<referenceY1> = -60
#<referenceY2> = -210
#<marbleDiaMin> = 24.00
#<marbleDiaMax> = 25.05
#<rowCount> = 9
#<colCount> = 9
#<divsPerCol> = 5
#<safeZ> = 5                        (safe height)
#<startZ> = 0.05                    (start first cutting pass)
(stepZ is calculated as 1/4 tool diameter)
#<thickness> = 4.4  					   (material thickness)
#<depth> = [#<thickness> * 0.75]    (pocket depth)
#<bottomGap> = [#<depth> * 0.15]    (between smallest marble and hole's bottom)
#<trimDepth> = 0.1                  (trim rim of hole)
#<engraveZ> = -0.1                  (Engraving depth)
#<swapZ> = 100                       (height to raise tool for switching bits)
#<overlap> = 0.1					(overlap between cuts) 
#<roundtooldia> = [1/4*25.4]        (rounded end mill tool diameter)
#<flattooldia> = [1/8*25.4]         (flat end mill tool diameter)
#<roundfeed> = 300                  (feed rate mm/min for rounded end mill)
#<flatfeed> = 300                   (feed rate mm/min for flat end mill)
#<engravingPlungeFeed> = 60			(feed rate for plunging with the engraver)
#<engravingLineFeed> = 120			(feed rate for tracing lines with the engraver)
#<RPM> = 4500                       (spindle RPM)

#<testData> = 0
o1 if [#<testData> gt 0]
    #<roundtooldia> = 2
    #<flattooldia> = 1
o1 endif


(G17 G90 G64 P0.1 S4500 M3 M8)
G0 Z#<safeZ>
g21                                 (use mm units)


( Text engraving code generated by engrave-11.py widget )
( by Lawrence Glaister VE7IT - 2008 )
( Engraving: "Akron" at 0.0 degrees)
( Fontfile: fonts/courier.cxf )
#1002 = 0.0000  ( X Start )
#1003 = 0.0000  ( Y Start )
#1004 = 0.5690  ( X Scale )
#1005 = 0.5690  ( Y Scale )
#1006 = 0.0000  ( Angle )
(===================================================================)
(Subroutine to handle x,y rotation about 0,0)
(input x,y get scaled, rotated then offset )
( [#1 = 0 or 1 for a G0 or G1 type of move], [#2=x], [#3=y])
o9000 sub
  #28 = [#2 * #1004]  ( scaled x )
  #29 = [#3 * #1005]  ( scaled y )
  #30 = [SQRT[#28 * #28 + #29 * #29 ]]   ( dist from 0 to x,y )
  #31 = [ATAN[#29]/[#28]]                ( direction to  x,y )
  #32 = [#30 * cos[#31 + #1006]]     ( rotated x )
  #33 = [#30 * sin[#31 + #1006]]     ( rotated y )
  o9010 if [#1 LT 0.5]
    G00 X[#32+#1002] Y[#33+#1003]
  o9010 else
    G01 X[#32+#1002] Y[#33+#1003]
  o9010 endif
o9000 endsub
(===================================================================)


o1000 sub (cut a profile with the ball mill)
    #<centreX> = #1
    #<centreY> = #2
    #<radius> = #3 (to middle of tool path)
    #<depth> = #4
    #<stepZ> = #5
    #<safeZ> = #6
    #<startZ> = #7
    g0 z[#<safeZ>]
    g0 x[#<centreX>] y[#<centreY> - #<radius>]
    #<currZ> = #<startZ>
    g1 z[#<currZ>]
    o1001 do
        #<currZ> = [#<currZ> - #<stepZ>]
	    o1002 if [#<currZ> lt -#<depth>]
	        #<currZ> = -#<depth>
	    o1002 endif
	    g3 j[#<radius>] z[#<currZ>] (spiral down)
	o1001 while [#<currZ> gt -#<depth>]

    g3 j[#<radius>] 	(cut flat circ. path at bottom height)
o1000 endsub

o2000 sub (cut a circular pocket with the end mill)
    #<centreX> = #1
    #<centreY> = #2
    #<holeRadius> = #3
    #<tooldia> = #4
    #<overlap> = #5
    #<depth> = #6
    #<stepZ> = #7
    #<safeZ> = #8
    #<startZ> = #9

	o2001 if [#<holeRadius>*2 le #<tooldia>]
	    m2   (can't fit flat end mill inside rounded end mill circle)
	o2001 endif
	#<currY> = [#<centreY> - #<tooldia>/2]
	o2002 while [#<currY> lt #<centreY> + #<holeRadius> - #<tooldia>/2]
	    #<currY> = [#<currY> + #<tooldia> - #<overlap>]
	    o2003 if [#<currY> gt #<centreY> + #<holeRadius> - #<tooldia>/2]
	        #<currY> = [#<centreY> + #<holeRadius> - #<tooldia>/2]
	    o2003 endif
	    g0 z[#<safeZ>]
	    g0 x[#<centreX>] y[#<currY>]
	    #<currZ> = #<startZ>
	    g1 z[#<currZ>]
	    o2004 do
	        #<currZ> = [#<currZ> - #<stepZ>]
		    o2005 if [#<currZ> lt -#<depth>]
		        #<currZ> = -#<depth>
		    o2005 endif
		    g3 j[#<centreY> - #<currY>] z[#<currZ>] (spiral down)
		o2004 while [#<currZ> gt -#<depth>]
	    g3 j[#<centreY> - #<currY>] 	(cut flat circ. path at bottom height)
	o2002 endwhile
o2000 endsub

(Engrave text "Akron")
o8000 sub
	#<safeZ> = #1
	#<engraveZ> = #2
	#<engravingPlungeFeed> = #3
	#<engravingLineFeed> = #4
	
	G0 Z#<safeZ>
	G4 P4
	(character 'A')
	G0 Z#<safeZ>
	o9000 call [0] [3.1944] [-9.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [8.0556] [-9.0593]
	G0 Z#<safeZ>
	o9000 call [0] [2.5000] [-2.8093]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [5.6250] [-2.8093]
	o9000 call [1] [10.0000] [-14.0593]
	G0 Z#<safeZ>
	o9000 call [0] [7.5000] [-14.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [11.2500] [-14.0593]
	G0 Z#<safeZ>
	o9000 call [0] [5.6250] [-2.8093]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [1.2500] [-14.0593]
	G0 Z#<safeZ>
	o9000 call [0] [0.0000] [-14.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [3.7500] [-14.0593]
	
	(character 'k')
	G0 Z#<safeZ>
	o9000 call [0] [22.2500] [-14.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [17.9615] [-9.2488]
	G0 Z#<safeZ>
	o9000 call [0] [24.1250] [-14.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [20.3750] [-14.0593]
	G0 Z#<safeZ>
	o9000 call [0] [21.6250] [-6.5593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [16.0000] [-10.6888]
	G0 Z#<safeZ>
	o9000 call [0] [23.5000] [-6.5593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [19.7500] [-6.5593]
	G0 Z#<safeZ>
	o9000 call [0] [13.5000] [-14.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [16.0000] [-14.0593]
	o9000 call [1] [16.0000] [-2.8093]
	o9000 call [1] [13.5000] [-2.8093]
	
	(character 'r')
	G0 Z#<safeZ>
	o9000 call [0] [27.6250] [-14.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [33.8750] [-14.0593]
	G0 Z#<safeZ>
	o9000 call [0] [36.1928] [-7.5883]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [35.4334] [-6.9756]
	o9000 call [1] [34.5221] [-6.6270]
	o9000 call [1] [33.5477] [-6.5765]
	o9000 call [1] [32.6052] [-6.8289]
	o9000 call [1] [31.7865] [-7.3597]
	o9000 call [1] [29.5000] [-9.4140]
	G0 Z#<safeZ>
	o9000 call [0] [27.6250] [-6.5593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [29.5000] [-6.5593]
	o9000 call [1] [29.5000] [-14.0593]
	
	(character 'o')
	G0 Z#<safeZ>
	o9000 call [0] [47.6343] [-9.1505]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [47.1016] [-8.1051]
	o9000 call [1] [46.2720] [-7.2755]
	o9000 call [1] [45.2266] [-6.7428]
	o9000 call [1] [44.0678] [-6.5593]
	o9000 call [1] [42.9090] [-6.7428]
	o9000 call [1] [41.8636] [-7.2755]
	o9000 call [1] [41.0340] [-8.1051]
	o9000 call [1] [40.5014] [-9.1505]
	o9000 call [1] [40.3178] [-10.3093]
	o9000 call [1] [40.5014] [-11.4681]
	o9000 call [1] [41.0340] [-12.5135]
	o9000 call [1] [41.8636] [-13.3431]
	o9000 call [1] [42.9090] [-13.8758]
	o9000 call [1] [44.0678] [-14.0593]
	o9000 call [1] [45.2266] [-13.8758]
	o9000 call [1] [46.2720] [-13.3431]
	o9000 call [1] [47.1016] [-12.5135]
	o9000 call [1] [47.6343] [-11.4681]
	o9000 call [1] [47.8178] [-10.3093]
	o9000 call [1] [47.6343] [-9.1505]
	
	(character 'n')
	G0 Z#<safeZ>
	o9000 call [0] [58.8178] [-14.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [58.8178] [-9.6843]
	o9000 call [1] [58.6517] [-8.6789]
	o9000 call [1] [58.1710] [-7.7805]
	o9000 call [1] [57.4267] [-7.0845]
	o9000 call [1] [56.4981] [-6.6648]
	o9000 call [1] [55.4839] [-6.5663]
	o9000 call [1] [54.4919] [-6.7993]
	o9000 call [1] [53.6276] [-7.3390]
	o9000 call [1] [52.5678] [-8.2722]
	G0 Z#<safeZ>
	o9000 call [0] [60.6928] [-14.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [56.9428] [-14.0593]
	G0 Z#<safeZ>
	o9000 call [0] [50.6928] [-14.0593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [54.4428] [-14.0593]
	G0 Z#<safeZ>
	o9000 call [0] [50.6928] [-6.5593]
	F #<engravingPlungeFeed>
	G1 Z#<engraveZ>
	F #<engravingLineFeed>
	o9000 call [1] [52.5678] [-6.5593]
	o9000 call [1] [52.5678] [-14.0593]
o8000 endsub

#<marbleDepth> = [#<depth> - #<bottomGap>]
#<pocketRadius> = [sqrt[#<marbleDiaMin> * #<marbleDepth> - #<marbleDepth> * #<marbleDepth>] - sqrt[#<roundtooldia> * #<depth> -  #<depth> * #<depth>]]
#<trimRadius> =   [sqrt[#<marbleDiaMin> * #<marbleDepth> - #<marbleDepth> * #<marbleDepth>] - sqrt[#<roundtooldia> * #<trimDepth> -  #<trimDepth> * #<trimDepth>]]
#<xstart> = [[#<referenceX1> + #<referenceX2>]/2 - [1+#<colcount>]/2*#<marbleDiaMax>]
#<ystart> = [[#<referenceY1> + #<referenceY2>]/2 + [1+#<colcount>]/2*#<marbleDiaMax>] 

o10000 if [#<cutReference> eq 1]
	f[#<flatfeed>]                      (set feed rate)
	m3 s[#<RPM>]                        (spindle start)
	g4 p4                               (pause 4 seconds)

	#<referenceXmin> = [#<xmin> + #<marbleDiaMax>/2]
	#<referenceXmax> = [#<xstart> - #<marbleDiaMax>/2 - #<flattooldia>/2 - 1.0]
	#<referenceYmax> = [#<ymax> - #<marbleDiaMax>/2]
	
	o6000 if [[#<referenceX1> gt #<referenceXmin>] and [#<referenceX1> lt #<referenceXmax>] and [#<referenceY1> lt #<referenceYmax>] and [#<ystart> + #<flattooldia>/2 lt #<ymax>]]
		o1000 call [#<referenceX1>] [#<referenceY1>] [#<marbleDiaMax>/2] [#<thickness> + 0.5] [#<flattooldia> / 4] [#<safeZ>] [#<startZ>]	
		o1000 call [#<referenceX1>] [#<referenceY2>] [#<marbleDiaMax>/2] [#<thickness> + 0.5] [#<flattooldia> / 4] [#<safeZ>] [#<startZ>]	
(		o1000 call [#<referenceX2>] [#<referenceY1>] [#<marbleDiaMax>/2] [#<thickness> + 0.5] [#<flattooldia> / 4] [#<safeZ>] [#<startZ>]	)
(		o1000 call [#<referenceX2>] [#<referenceY2>] [#<marbleDiaMax>/2] [#<thickness> + 0.5] [#<flattooldia> / 4] [#<safeZ>] [#<startZ>]	)
	o6000 endif

	g0 z[#<swapZ>]
	m5 									(stop spindle)
o10000 endif

o11000 if [#<cutBoundary> eq 1]
	f[#<flatfeed>]                      (set feed rate)
	m3 s[#<RPM>]                        (spindle start)
	g4 p4                               (pause 4 seconds)

	#<boundaryDepth> = [-1.0 - #<thickness>]
    g0 z[#<safeZ>]


    g0 x[#<xstart> - #<flattooldia>/2 - 1.0] y[#<ystart> - [1+#<colcount>]*#<marbleDiaMax>*3/4]
    #<currZ> = #<startZ>
    g1 z[#<currZ>]
    o7000 do
        #<currZ> = [#<currZ> - #<flattooldia>/4]
	    o7001 if [#<currZ> lt #<boundaryDepth>]
	        #<currZ> = #<boundaryDepth>
	    o7001 endif
	    (flare in up to middle of left edge with slant down)
	    g1 x[#<xstart> - #<flattooldia>/2] y[#<ystart> - [1+#<colcount>]*#<marbleDiaMax>/2] z[#<currZ>]
	    (up left edge)
	    g1 y[#<ystart> - #<marbleDiaMax>/#<divsPerCol>/2]
	    (round top left corner)
	    g2 i[#<flattooldia>/2 + #<marbleDiaMax>/#<divsPerCol>/2] x[#<xstart> + #<marbleDiaMax>/#<divsPerCol>/2] y[#<ystart> + #<flattooldia>/2]
	    (across top)
	    g1 x[#<xstart> + [1-[1/#<divsPerCol>/2]+#<colcount>]*#<marbleDiaMax>]
	    (round top right corner)
	    g2 j[-#<flattooldia>/2 - #<marbleDiaMax>/#<divsPerCol>/2] x[#<xstart> + [1+#<colcount>]*#<marbleDiaMax> + #<flattooldia>/2] y[#<ystart> - #<marbleDiaMax>/#<divsPerCol>/2]
	    (down to middle of right edge)
	    g1 y[#<ystart> - [1+#<colcount>]*#<marbleDiaMax>/2]
	    (flare out 3/4 down right edge)
	    g1 x[#<xstart> + [1+#<colcount>]*#<marbleDiaMax> + #<flattooldia>/2 + 1.0] y[#<ystart> - [1+#<colcount>]*#<marbleDiaMax>*3/4]
	    
	    
        #<currZ> = [#<currZ> - #<flattooldia>/4]
	    o7001 if [#<currZ> lt #<boundaryDepth>]
	        #<currZ> = #<boundaryDepth>
	    o7001 endif
	    (flare in up to middle of right edge with slant down)
	    g1 x[#<xstart> + [1+#<colcount>]*#<marbleDiaMax> + #<flattooldia>/2] y[#<ystart> - [1+#<colcount>]*#<marbleDiaMax>/2] z[#<currZ>]
	    (up right edge)
	    g1 y[#<ystart> - #<marbleDiaMax>/#<divsPerCol>/2]
	    (round top right corner)
	    g3 i[-#<flattooldia>/2 - #<marbleDiaMax>/#<divsPerCol>/2] x[#<xstart> + [1-[1/#<divsPerCol>/2]+#<colcount>]*#<marbleDiaMax>] y[#<ystart> + #<flattooldia>/2]
	    (across top)
	    g1 x[#<xstart> + #<marbleDiaMax>/#<divsPerCol>/2]
	    (round top left corner)
	    g3 j[-#<flattooldia>/2 - #<marbleDiaMax>/#<divsPerCol>/2] x[#<xstart> - #<flattooldia>/2] y[#<ystart> - #<marbleDiaMax>/#<divsPerCol>/2]
	    (down to middle of left edge)
	    g1 y[#<ystart> - [1+#<colcount>]*#<marbleDiaMax>/2]
	    (flare out 3/4 down left edge)
	    g1 x[#<xstart> - #<flattooldia>/2 - 1.0] y[#<ystart> - [1+#<colcount>]*#<marbleDiaMax>*3/4]
	o7000 while [#<currZ> gt #<boundaryDepth>]
    (g1 y[#<ystart> - [1-[1/#<divsPerCol>/2]+#<colcount>]*#<marbleDiaMax>]) 	(cut flat path at bottom height)


	
o11000 endif

o15000 if [#<cutPocket> eq 1]
	f[#<flatfeed>]                      (set feed rate)
	m3 s[#<RPM>]                        (spindle start)
	g4 p4                               (pause 4 seconds)
	
	#<i> = 0
	o4000 while [#<i> lt #<colCount>]
		#<currX> = [#<xstart> + #<marbleDiaMax> * [#<i> + 1]]
		#<j> = 0
		o4100 while [#<j> lt #<rowCount>]
			#<currY> = [#<ystart> - #<marbleDiaMax> * [#<j> + 1]]
			o2000 call [#<currX>] [#<currY>] [#<pocketRadius>] [#<flattooldia>] [#<overlap>] [#<depth>] [#<flattooldia> / 4] [#<safeZ>] [#<startZ>]
		   	#<j> = [#<j> + 1]
		o4100 endwhile
		#<i> = [#<i> + 1]
	o4000 endwhile
	
	g0 z[#<swapZ>]
	m5 									(stop spindle)
o15000 endif

o20000 if [#<cutProfile> eq 1]	
	f[#<roundfeed>]                     (set feed rate)
	g0 z[#<safeZ>]
	
	m3 s[#<RPM>]                        (spindle start)
	g4 p4                               (pause 4 seconds)
	
	#<i> = 0
	o3000 while [#<i> lt #<colCount>]
		#<currX> = [#<xstart> + #<marbleDiaMax> * [#<i> + 1]]
		#<j> = 0
		o3100 while [#<j> lt #<rowCount>]
			#<currY> = [#<ystart> - #<marbleDiaMax> * [#<j> + 1]]
		   	o1000 call [#<currX>] [#<currY>] [#<pocketRadius>] [#<depth>] [#<roundtooldia> / 4] [#<safeZ>] [#<startZ>]
		   	o1000 call [#<currX>] [#<currY>] [#<trimRadius>] [#<trimDepth>] [#<roundtooldia> / 4] [#<safeZ>] [#<startZ>]
		   	#<j> = [#<j> + 1]
		o3100 endwhile
		#<i> = [#<i> + 1]
	o3000 endwhile
	
	g0 z[#<swapZ>]
	m5 									(stop spindle)
o20000 endif

o30000 if [#<cutEngraving> eq 1]
	f[#<engravingPlungefeed>]                     (set feed rate)
	g0 z[#<safeZ>]
	
	m3 s[#<RPM>]                        (spindle start)
	g4 p4                               (pause 4 seconds)
	
	#<xrev> = 0
	o5000 while [#<xrev> lt 2]
		#<startX> = [#<xstart> + #<xrev>*[#<colcount>+1]*#<marbleDiaMax>]
		#<xSign> = [1 - 2*#<xrev>]
		#<startY> = [#<ystart>]
		#<i> = 0
		o5200 while [#<i> lt 2 * #<colcount> * #<divspercol>]
			g0 Z[#<safeZ>]
			g0 X[#<startX>+#<xSign>*#<i>*#<marbleDiaMax>/2/#<divspercol>] Y[#<startY>]
			f[#<engravingPlungefeed>]                     (set feed rate)
			g1 Z[#<engraveZ>]
			f[#<engravingLinefeed>]                     (set feed rate)
			g1 X[#<startX> + #<xSign>*#<i>*#<marbleDiaMax>/2/#<divspercol> + #<xSign>*#<marbleDiaMax>/2] Y[#<startY> - #<marbleDiaMax>/2]

			#<i> = [#<i> + 1]
		o5200 endwhile
		
		#<i> = 0
		o5300 while [#<i> lt 2*#<divspercol>]
			g0 Z[#<safeZ>]
			g0 X[#<startX>+#<xSign>*[#<colcount>*#<marbleDiaMax> + #<i>*#<marbleDiaMax>/2/#<divspercol>]] Y[#<startY>]
			f[#<engravingPlungefeed>]                     (set feed rate)
			g1 Z[#<engraveZ>]
			f[#<engravingLinefeed>]                     (set feed rate)
			g1 X[#<startX> + #<xSign>*#<marbleDiaMax>/2*[2*#<colcount> + 1 + #<i>/2/#<divspercol>]] Y[#<startY> - #<marbleDiaMax>/2*[1 - #<i>/2/#<divspercol>]]
			#<i> = [#<i> + 1]
		o5300 endwhile
		#<xrev> = [#<xrev> + 1]	
	o5000 endwhile 
	
    #<scale> = [#<marbleDiaMax>/2 / 15] 
    #1002 = [#<xstart> + [0.5]*#<marbleDiaMax>]	 	(Start X)
    #1003 = [#<ystart> - [0.5]*#<marbleDiaMax> - #<scale> * 60.7]					(Start Y)
    #1004 = #<scale> (X Scale from base width of 60.7)
    #1005 = -#<scale>  (Y Scale from base height of 11.2)
    #1006 = 90        (Angle)
	o8000 call [#<safeZ>] [#<engraveZ>] [#<engravingPlungeFeed>] [#<engravingLineFeed>]
	
	
o30000 endif

o40000 if [#<cutSquareEngraving> eq 1]
	f[#<engravingPlungefeed>]                     (set feed rate)
	g0 z[#<safeZ>]
	
	m3 s[#<RPM>]                        (spindle start)
	g4 p4                               (pause 4 seconds)
	
	g0 Z[#<safeZ>]
	g0 X[#<xstart> + #<marbleDiaMax>/2] Y[#<ystart> - #<marbleDiaMax>/2]
	f[#<engravingPlungefeed>]                     (set feed rate)
	g1 Z#<engraveZ>
	f[#<engravingLinefeed>]                     (set feed rate)
	g1 X[#<xstart> + [#<colcount> + 0.5]*#<marbleDiaMax>] Y[#<ystart> - [0.5]*#<marbleDiaMax>]
	g1 X[#<xstart> + [#<colcount> + 0.5]*#<marbleDiaMax>] Y[#<ystart> - [#<rowcount> + 0.5]*#<marbleDiaMax>]
	g1 X[#<xstart> + [0.5]*#<marbleDiaMax>] Y[#<ystart> - [#<rowcount> + 0.5]*#<marbleDiaMax>]
	g1 X[#<xstart> + [0.5]*#<marbleDiaMax>] Y[#<ystart> - [0.5]*#<marbleDiaMax>]
	g0 Z[#<safeZ>]
o40000 endif

m30                                 (program end and rewind)
